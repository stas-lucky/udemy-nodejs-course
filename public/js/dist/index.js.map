{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/stripe.js","public/js/index.js","public/js/login.js","public/js/updateSettings.js"],"sourcesContent":["/* eslint-disable */\nexport const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    \"pk.eyJ1Ijoic3Rhc2x1Y2t5IiwiYSI6ImNreHQ1MTV2NzFzaW8yb29lOXhxdGplMmkifQ.Iz4L8CYciewTg4roi1a2Cg\";\n  var map = new mapboxgl.Map({\n    container: \"map\",\n    style: \"mapbox://styles/staslucky/ckxtinmci85db16ryy4uqeros\",\n    scrollZoom: false,\n    // center: [-118.130208, 33.95564],\n    // zoom: 8,\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  // console.log(\"LOC: \", locations);\n  locations.forEach((loc) => {\n    // Create marker\n    const el = document.createElement(\"div\");\n    el.className = \"marker\";\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: \"bottom\",\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n      .addTo(map);\n\n    // Extend map bounds to include current location\n    bounds.extend(loc.ccordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100,\n    },\n  });\n};\n","export const hideAlert = (type, msg) => {\n  const el = document.querySelector(\".alert\");\n  if (el) {\n    el.parentElement.removeChild(el);\n  }\n};\n\n// type is \"success\" or \"error\"\nexport const showAlert = (type, msg, time = 5) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n\n  window.setTimeout(hideAlert, time * 1000);\n};\n","import axios from \"axios\";\nimport { showAlert } from \"./alerts\";\nconst stripe = Stripe(\n  \"pk_test_51KDxriLb2aCWH5bw5LLwxaRFXZddjQJg2ZFYAzM3McOmd1KpzWn5XXMdqPBMnPyT6QY8v3uoGVdygHbeMA6DQFGH003bAKk4cw\"\n);\n\nexport const bookTour = async (tourId) => {\n  try {\n    const session = await axios({\n      method: \"GET\",\n      url: `/api/v1/bookings/checkout-session/${tourId}`,\n    });\n\n    // console.log(session);\n\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n\n    // if (res.data.status === \"success\") {\n    //   showAlert(\"success\", \"Logged in!\");\n    //   window.setTimeout(() => {\n    //     location.assign(\"/\");\n    //   }, 1500);\n    // }\n    //console.log(res);\n  } catch (err) {\n    console.log(err);\n    showAlert(\"error\", err);\n  }\n};\n","import \"@babel/polyfill\";\n\nimport { displayMap } from \"./mapbox\";\nimport { login, logout } from \"./login\";\nimport { updateData, updatePassword } from \"./updateSettings\";\nimport { bookTour } from \"./stripe\";\nimport { showAlert } from \"./alerts\";\n\n// Elements\nconst mapBox = document.getElementById(\"map\");\nconst loginForm = document.querySelector(\".form--login\");\nconst logOutBtn = document.querySelector(\".nav__el--logout\");\nconst userDataForm = document.querySelector(\".form-user-data\");\nconst userSettingsForm = document.querySelector(\".form-user-settings\");\nconst bookBtn = document.getElementById(\"book-tour\");\n\n// Values\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  try {\n    displayMap(locations);\n  } catch (err) {\n    console.error(\"Mapbox error\", err);\n  }\n}\n\nif (loginForm) {\n  loginForm.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n\n    await login(email, password);\n  });\n}\n\nif (logOutBtn) {\n  logOutBtn.addEventListener(\"click\", logout);\n}\n\nif (userDataForm) {\n  userDataForm.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"name\", document.getElementById(\"name\").value);\n    form.append(\"email\", document.getElementById(\"email\").value);\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n\n    // console.log(form);\n\n    // for (let f of form) console.log(f);\n\n    await updateData(form);\n  });\n}\n\nif (userSettingsForm) {\n  userSettingsForm.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n\n    const currentPassword = document.getElementById(\"password-current\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n\n    await updatePassword(currentPassword, password, passwordConfirm);\n\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener(\"click\", async (e) => {\n    e.target.textContent = \"Processing...\";\n    const { tourId } = e.target.dataset;\n    await bookTour(tourId);\n    e.target.textContent = \"Book tour\";\n  });\n}\n\nconst alertMessage = document.querySelector(\"body\").dataset.alert;\nif (alertMessage) showAlert(\"success\", alertMessage, 20);\n","import axios from \"axios\";\nimport { showAlert } from \"./alerts\";\n\nexport const login = async (email, password) => {\n  //console.log(email, password);\n  try {\n    const res = await axios({\n      method: \"POST\",\n      url: \"/api/v1/users/login\",\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === \"success\") {\n      showAlert(\"success\", \"Logged in!\");\n      window.setTimeout(() => {\n        location.assign(\"/\");\n      }, 1500);\n    }\n    //console.log(res);\n  } catch (err) {\n    console.log(err.response.data);\n    showAlert(\"error\", err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: \"GET\",\n      url: \"/api/v1/users/logout\",\n    });\n    if (res.data.status === \"success\") {\n      location.reload(true); // true forces to reload from server, not from\n    }\n  } catch (err) {\n    showError(\"Error\", \"Erro logging our. Please try again\");\n  }\n};\n","import axios from \"axios\";\nimport { showAlert } from \"./alerts\";\n\nexport const updateData = async (data) => {\n  try {\n    const res = await axios({\n      method: \"PATCH\",\n      url: \"/api/v1/users/updateMe\",\n      data,\n    });\n\n    if (res.data.status === \"success\") {\n      showAlert(\"success\", \"Data updated successfully\");\n    }\n  } catch (err) {\n    showAlert(\"error\", err.response.data.message);\n  }\n};\n\nexport const updatePassword = async (\n  currentPassword,\n  password,\n  passwordConfirm\n) => {\n  try {\n    const res = await axios({\n      method: \"PATCH\",\n      url: \"/api/v1/users/updateMyPassword\",\n      data: {\n        currentPassword,\n        password,\n        passwordConfirm,\n      },\n    });\n\n    if (res.data.status === \"success\") {\n      showAlert(\"success\", \"Password updated successfully\");\n    }\n  } catch (err) {\n    showAlert(\"error\", err.response.data.message);\n  }\n};\n"],"names":["$9f0ccb0ec93b7674$export$516836c6a9dfc573","type","msg","el","document","querySelector","parentElement","removeChild","$9f0ccb0ec93b7674$export$de026b00723010c1","time","markup","insertAdjacentHTML","window","setTimeout","$b0615518ebe63bb3$var$stripe","Stripe","$e611c6e6312ddaa7$var$mapBox","getElementById","$e611c6e6312ddaa7$var$loginForm","$e611c6e6312ddaa7$var$logOutBtn","$e611c6e6312ddaa7$var$userDataForm","$e611c6e6312ddaa7$var$userSettingsForm","$e611c6e6312ddaa7$var$bookBtn","locations","JSON","parse","dataset","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","ccordinates","fitBounds","padding","top","bottom","left","right","$41a735836934a95f$export$4c5dd147b21b9176","err","console","error","addEventListener","async","e","preventDefault","email","value","password","$parcel$interopDefault","$gZOH9$axios","method","url","data","status","location","assign","log","response","message","$c33b32e133ecc953$export$596d806903d1f59e","reload","showError","form","FormData","append","files","$cb707bb35696bcf5$export$3bf0495508a61ee","textContent","currentPassword","passwordConfirm","$cb707bb35696bcf5$export$e2853351e15b7895","target","tourId","session","redirectToCheckout","sessionId","id","$b0615518ebe63bb3$export$8d5bdbf26681c0c2","$e611c6e6312ddaa7$var$alertMessage","alert"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}